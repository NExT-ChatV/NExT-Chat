<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="github-markdown.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <title>Project structure of: NExT-ChatV/NExT-Chat</title>
    <style>
        .directory:hover {
            cursor: pointer;
            text-decoration: underline;
        }

        :target {
            background-color: yellow !important;
        }

        .folded::before {
            content: '\25B6';
            margin-right: 8px;
            /* Add space between marker and text */
        }

        .expanded::before {
            content: '\25BC';
            margin-right: 8px;
            /* Add space between marker and text */
        }
    </style>
    <script>
        function toggleVisibility(element) {
            let mclass = element.getAttribute("class");
            if (mclass == "expanded") {
                element.setAttribute('class', 'folded');
            } else {
                element.setAttribute('class', 'expanded');
            }
            const siblings = element.parentNode.children;
            for (const sibling of siblings) {
                if (sibling !== element) {
                    sibling.style.display = (sibling.style.display === 'none') ? 'block' : 'none';
                }
            }
        }
    </script>
    <style>
        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 45px;
        }

        @media (max-width: 767px) {
            .markdown-body {
                padding: 15px;
            }

            .partial-repository-url {
                display: none;
            }
        }

        ul {
            list-style: none;
        }
        #feeling-lucky:hover{
            cursor: pointer;
        }
    </style>
</head>

<body>
    <article class="markdown-body">
        <h2>Project structure<span hierarchy="0" class="partial-repository-url"> of: NExT-ChatV/NExT-Chat</span><div style="float: right;"><a title="Document index" style="margin:3.5px;" href="index.html"><i class="bi bi-search"></i></a><a title="Feeling lucky" style="margin:3.5px;" id="feeling-lucky" href="#"><i class="bi bi-dice-3"></i></a><a title="Expand tree" style="margin:3.5px;" href="tree.html?full=true" id="expand-tree"><i class="bi bi-caret-down-square"></i></a></div></h2>
<ul>
<li><span hierarchy="0" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/"><code>NExT-Chat</code></strong> <em>Trains multimodal models in 3 stages, Python.</em></span><ul>
<li><span hierarchy="1" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/config/"><code>config</code></strong> <em>NextChat configuration files</em></span><ul>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/config/_base_/"><code>&UnderBar;base&UnderBar;</code></strong> <em>NextChat model configuration code and training with distributed learning.</em></span><ul>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/config/_base_/model/"><code>model</code></strong></span><ul>
<li><a class="file_link" href="index.html?q=/config/_base_/model/nextchat.py" id="/config/_base_/model/nextchat.py"><code>nextchat&period;py</code></a> <em>NextChat model configuration code</em></li>
</ul>
</li>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/config/_base_/train/"><code>train</code></strong> <em>Training ML model with distributed learning and mixed precision.</em></span><ul>
<li><a class="file_link" href="index.html?q=/config/_base_/train/eval.py" id="/config/_base_/train/eval.py"><code>eval&period;py</code></a> <em>Training arguments config for model.</em></li>
<li><a class="file_link" href="index.html?q=/config/_base_/train/nextchat_fsdp.py" id="/config/_base_/train/nextchat_fsdp.py"><code>nextchat&UnderBar;fsdp&period;py</code></a> <em>Trains LlamaDecoderLayer with mixed precision, distributed learning</em></li>
<li><a class="file_link" href="index.html?q=/config/_base_/train/nextchat_non.py" id="/config/_base_/train/nextchat_non.py"><code>nextchat&UnderBar;non&period;py</code></a> <em>Training args for ML model: output dir, batch size, epochs, learning rate.</em></li>
</ul>
</li>
</ul>
</li>
<li><a class="file_link" href="index.html?q=/config/nextchat_eval_multi_rec.py" id="/config/nextchat_eval_multi_rec.py"><code>nextchat&UnderBar;eval&UnderBar;multi&UnderBar;rec&period;py</code></a> <em>Multi-predict NextChat model evaluation setup</em></li>
<li><a class="file_link" href="index.html?q=/config/nextchat_eval_multi_res.py" id="/config/nextchat_eval_multi_res.py"><code>nextchat&UnderBar;eval&UnderBar;multi&UnderBar;res&period;py</code></a> <em>Nextchat model prep for evaluation and prediction</em></li>
<li><a class="file_link" href="index.html?q=/config/nextchat_eval_pope.py" id="/config/nextchat_eval_pope.py"><code>nextchat&UnderBar;eval&UnderBar;pope&period;py</code></a> <em>Base config for NExT-Chat training, evaluation, and prediction tasks.</em></li>
<li><a class="file_link" href="index.html?q=/config/nextchat_eval_reg_cap.py" id="/config/nextchat_eval_reg_cap.py"><code>nextchat&UnderBar;eval&UnderBar;reg&UnderBar;cap&period;py</code></a> <em>Configure NextChat for evaluation &amp; prediction</em></li>
<li><a class="file_link" href="index.html?q=/config/nextchat_stage1.py" id="/config/nextchat_stage1.py"><code>nextchat&UnderBar;stage1&period;py</code></a> <em>NextChat Stage 1 model initialization and training arguments.</em></li>
<li><a class="file_link" href="index.html?q=/config/nextchat_stage2.py" id="/config/nextchat_stage2.py"><code>nextchat&UnderBar;stage2&period;py</code></a> <em>NextChat Stage 2 config: base, train args, model-specific, 2 epochs, 4096 tokens, FairSeq</em></li>
<li><a class="file_link" href="index.html?q=/config/nextchat_stage3.py" id="/config/nextchat_stage3.py"><code>nextchat&UnderBar;stage3&period;py</code></a> <em>NextChat stage 3 config: dataset, model, training params.</em></li>
</ul>
</li>
<li><a class="file_link" href="index.html?q=/DATA.md" id="/DATA.md"><code>DATA&period;md</code></a> <em>Organize Shikra data in 'data' folder, update image settings.</em></li>
<li><a class="file_link" href="index.html?q=/eval_pope.sh" id="/eval_pope.sh"><code>eval&UnderBar;pope&period;sh</code></a> <em>Launch 8-process CUDA finetuning job for NextChat model evaluation.</em></li>
<li><a class="file_link" href="index.html?q=/eval_rec.sh" id="/eval_rec.sh"><code>eval&UnderBar;rec&period;sh</code></a> <em>Multi-modal language model finetuning with evaluation.</em></li>
<li><a class="file_link" href="index.html?q=/eval_reg_cap.sh" id="/eval_reg_cap.sh"><code>eval&UnderBar;reg&UnderBar;cap&period;sh</code></a> <em>Multi-process accelerated ML model fine-tuning, config: nextchat_eval_reg_cap.py</em></li>
<li><a class="file_link" href="index.html?q=/eval_res.sh" id="/eval_res.sh"><code>eval&UnderBar;res&period;sh</code></a> <em>Accelerate library launched, executes mllm/pipeline with specific config, CUDA devices.</em></li>
<li><span hierarchy="1" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/"><code>mllm</code></strong> <em>Machine Learning Language Model Datasets</em></span><ul>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/config/"><code>config</code></strong> <em>MLLM training configuration</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/config/__init__.py" id="/mllm/config/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Prepares arguments for program usage.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/config/config.py" id="/mllm/config/config.py"><code>config&period;py</code></a> <em>Training configuration setup.</em></li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/conversation/"><code>conversation</code></strong> <em>Interactive renewable energy conversation.</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/conversation/__init__.py" id="/mllm/conversation/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports essentials from base_conversation module.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/conversation/base_conversation.py" id="/mllm/conversation/base_conversation.py"><code>base&UnderBar;conversation&period;py</code></a> <em>Conversation class, styling functions, gradio/OpenAI support, renewable energy benefits.</em></li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/dataset/"><code>dataset</code></strong> <em>Machine Learning Language Models Datasets</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/dataset/__init__.py" id="/mllm/dataset/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports and consolidates functionalities for data processing.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/builder.py" id="/mllm/dataset/builder.py"><code>builder&period;py</code></a> <em>Builds NExT-Chat dataset with transforms</em></li>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/dataset/process_function/"><code>process&UnderBar;function</code></strong> <em>Process chat data functions for AI models directory.</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/dataset/process_function/__init__.py" id="/mllm/dataset/process_function/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports various process functions for handling data processing.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/process_function/box_process_function.py" id="/mllm/dataset/process_function/box_process_function.py"><code>box&UnderBar;process&UnderBar;function&period;py</code></a> <em>BoxFormatProcess &amp; TokenFormatter combined for NExT-Chat model preprocessing</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/process_function/chat_process_function.py" id="/mllm/dataset/process_function/chat_process_function.py"><code>chat&UnderBar;process&UnderBar;function&period;py</code></a> <em>Process chat data for AI models.</em></li>
</ul>
</li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/root.py" id="/mllm/dataset/root.py"><code>root&period;py</code></a> <em>Conversation data processors with placeholders and three function types.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/single_image_convsation.py" id="/mllm/dataset/single_image_convsation.py"><code>single&UnderBar;image&UnderBar;convsation&period;py</code></a> <em>Single-image conversation dataset class.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/single_image_interactive.py" id="/mllm/dataset/single_image_interactive.py"><code>single&UnderBar;image&UnderBar;interactive&period;py</code></a> <em>Single image dataset class for chat apps.</em></li>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/dataset/utils/"><code>utils</code></strong> <em>Image, dataset processing utilities</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/__init__.py" id="/mllm/dataset/utils/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports util functions for data tasks.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/compute_metrics.py" id="/mllm/dataset/utils/compute_metrics.py"><code>compute&UnderBar;metrics&period;py</code></a> <em>Compute transformer model metrics and decode IDs</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/concatenate_dataset.py" id="/mllm/dataset/utils/concatenate_dataset.py"><code>concatenate&UnderBar;dataset&period;py</code></a> <em>Concatenates, undersamples, and oversamples PyTorch datasets.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/flickr30k_entities_utils.py" id="/mllm/dataset/utils/flickr30k_entities_utils.py"><code>flickr30k&UnderBar;entities&UnderBar;utils&period;py</code></a> <em>Flattens Flickr30kEntities dataset for efficient storage.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/io.py" id="/mllm/dataset/utils/io.py"><code>io&period;py</code></a> <em>Reads images from paths, handles S3, logs time</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/mixin.py" id="/mllm/dataset/utils/mixin.py"><code>mixin&period;py</code></a> <em>Mixin-based question template dataset class</em></li>
<li><a class="file_link" href="index.html?q=/mllm/dataset/utils/transform.py" id="/mllm/dataset/utils/transform.py"><code>transform&period;py</code></a> <em>Image and bounding box transformations for NExT-Chat dataset</em></li>
</ul>
</li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/demo/"><code>demo</code></strong> <em>NextChat image-powered GUI chatbot demo</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/demo/bash_demo.py" id="/mllm/demo/bash_demo.py"><code>bash&UnderBar;demo&period;py</code></a> <em>Test bash demo for NextChat model interaction.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/demo/demo_util.py" id="/mllm/demo/demo_util.py"><code>demo&UnderBar;util&period;py</code></a> <em>Generate AI chat system responses with image processing</em></li>
<li><a class="file_link" href="index.html?q=/mllm/demo/web_demo.py" id="/mllm/demo/web_demo.py"><code>web&UnderBar;demo&period;py</code></a> <em>GUI chatbot with image recognition, grounding, captioning, and response capabilities.</em></li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/engine/"><code>engine</code></strong> <em>MLLM-based chatbot engine with preprocessing</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/engine/__init__.py" id="/mllm/engine/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports modules for trainer classes and collator initialization.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/engine/base_engine.py" id="/mllm/engine/base_engine.py"><code>base&UnderBar;engine&period;py</code></a> <em>Base engine: collator, prediction, metrics, loss, evaluation, saving.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/engine/builder.py" id="/mllm/engine/builder.py"><code>builder&period;py</code></a> <em>Prepare trainer-collator for model with preprocessor dictionary</em></li>
<li><a class="file_link" href="index.html?q=/mllm/engine/nextchat.py" id="/mllm/engine/nextchat.py"><code>nextchat&period;py</code></a> <em>NextChatTrainer: MMLLM-based chatbot model trainer with state saving.</em></li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/models/"><code>models</code></strong> <em>NextChat models, AI language w/vision, image transforms.</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/models/__init__.py" id="/mllm/models/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Load pre-trained models with NextChat.</em></li>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/models/builder/"><code>builder</code></strong> <em>Pre-existing and customizable NExT-Chat models directory.</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/models/builder/__init__.py" id="/mllm/models/builder/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Load pre-existing models for further processing or training.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/models/builder/build_nextchat.py" id="/mllm/models/builder/build_nextchat.py"><code>build&UnderBar;nextchat&period;py</code></a> <em>NextChat model builder initialization and customization</em></li>
<li><a class="file_link" href="index.html?q=/mllm/models/builder/builder.py" id="/mllm/models/builder/builder.py"><code>builder&period;py</code></a> <em>Load pre-trained NExT-Chat models.</em></li>
</ul>
</li>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/models/nextchat/"><code>nextchat</code></strong> <em>Multi-modal AI language models with vision</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/models/nextchat/__init__.py" id="/mllm/models/nextchat/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports NextChat classes</em></li>
<li><a class="file_link" href="index.html?q=/mllm/models/nextchat/nextchat_base.py" id="/mllm/models/nextchat/nextchat_base.py"><code>nextchat&UnderBar;base&period;py</code></a> <em>Initializes AI chat models, handles multimodal inputs, checks shapes. Prints box_iou mean.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/models/nextchat/nextchat_seg.py" id="/mllm/models/nextchat/nextchat_seg.py"><code>nextchat&UnderBar;seg&period;py</code></a> <em>Language Modeling Class with Vision Tower</em></li>
</ul>
</li>
<li><span hierarchy="3" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/models/sam/"><code>sam</code></strong> <em>Transformer segmentation models, custom losses, image transforms</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/models/sam/modeling_sam.py" id="/mllm/models/sam/modeling_sam.py"><code>modeling&UnderBar;sam&period;py</code></a> <em>Image attending Transformer model with MHA, window attention.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/models/sam/sam_loss.py" id="/mllm/models/sam/sam_loss.py"><code>sam&UnderBar;loss&period;py</code></a> <em>Custom loss functions for segmentation models. Focal, Dice, and IOU losses combined.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/models/sam/transforms.py" id="/mllm/models/sam/transforms.py"><code>transforms&period;py</code></a> <em>Image resizing and padding transforms in <code>transforms.py</code></em></li>
</ul>
</li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/pipeline/"><code>pipeline</code></strong> <em>Python ML pipeline for LLaMA finetuning with memory optimization</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/pipeline/finetune.py" id="/mllm/pipeline/finetune.py"><code>finetune&period;py</code></a> <em>Trains ML model, logs metrics, saves models, handles errors, multi-predict.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/pipeline/finetune_mem.py" id="/mllm/pipeline/finetune_mem.py"><code>finetune&UnderBar;mem&period;py</code></a> <em>Python script finetunes LLaMA with FlashAttn for memory efficiency.</em></li>
</ul>
</li>
<li><span hierarchy="2" class="expanded" onclick="toggleVisibility(this)" ><strong class="directory" id="/mllm/utils/"><code>utils</code></strong> <em>Image and text utilities for bounding box manipulation.</em></span><ul>
<li><a class="file_link" href="index.html?q=/mllm/utils/__init__.py" id="/mllm/utils/__init__.py"><code>&UnderBar;&UnderBar;init&UnderBar;&UnderBar;&period;py</code></a> <em>Imports utilities for image and text tasks.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/utils/box_ops.py" id="/mllm/utils/box_ops.py"><code>box&UnderBar;ops&period;py</code></a> <em>Box operation utilities for bounding box manipulation and more.</em></li>
<li><a class="file_link" href="index.html?q=/mllm/utils/common.py" id="/mllm/utils/common.py"><code>common&period;py</code></a> <em>Image processing and text manipulation utilities.</em></li>
</ul>
</li>
</ul>
</li>
<li><a class="file_link" href="index.html?q=/README.md" id="/README.md"><code>README&period;md</code></a> <em>NextChat: Chat LMM with image-based text generation, improved model</em></li>
<li><a class="file_link" href="index.html?q=/requirements.txt" id="/requirements.txt"><code>requirements&period;txt</code></a> <em>Essential Python libraries for codebase execution.</em></li>
<li><a class="file_link" href="index.html?q=/run_stage1.sh" id="/run_stage1.sh"><code>run&UnderBar;stage1&period;sh</code></a> <em>Fine-tune multimodal language model in 2 epochs.</em></li>
<li><a class="file_link" href="index.html?q=/run_stage2.sh" id="/run_stage2.sh"><code>run&UnderBar;stage2&period;sh</code></a> <em>Runs Stage 2, finetunes model with 8 processes</em></li>
<li><a class="file_link" href="index.html?q=/run_stage3.sh" id="/run_stage3.sh"><code>run&UnderBar;stage3&period;sh</code></a> <em>Runs 8-process accelerated training for stage 3 model, saving every 5000 steps.</em></li>
</ul>
</li>
</ul>
    </article>
    <script type="text/javascript">
        function getQueryParams() {
            var search = window.location.search.substring(1); // Remove leading '?'
            var queryParams = {};
            search.split('&').forEach(function (pair) {
                var parts = pair.split('=');
                var key = decodeURIComponent(parts[0]);
                var value = decodeURIComponent(parts[1]);
                queryParams[key] = value;
            });
            return queryParams;
        }

        const queryParams = getQueryParams(window.location.search);
        const show_full = queryParams.full == "true";
        //const is_random = queryParams.random == 'true';
        function feelingLucky() {
            var elements = document.getElementsByClassName("file_link");
            var randomIndex = Math.floor(Math.random() * elements.length);
            window.location = elements[randomIndex].href;
        }
        //if (is_random) {feelingLucky();}
        document.getElementById("feeling-lucky").onclick = feelingLucky;
        if (!show_full) {
            const spans = document.querySelectorAll('span');
            for (let span of spans) {
                if (span.getAttribute("hierarchy") == '0') { continue }
                toggleVisibility(span);
            }
        } else {
            const expand_elem = document.getElementById('expand-tree');
            expand_elem.setAttribute("href", "tree.html");
            expand_elem.setAttribute("title", "Undo expand");
            expand_elem.innerHTML = '<i class="bi bi-caret-up-square"></i>'
        }

    </script>
</body>

</html>